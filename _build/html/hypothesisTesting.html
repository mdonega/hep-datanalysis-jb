
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hypotheses Testing {#ChapterHypothesisTesting} &#8212; Statistical Methods and Data Analysis Techniques</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Confidence Intervals {#ChapterConfidenceLimits}" href="confidenceIntervals.html" />
    <link rel="prev" title="Parameter Estimation - Least Squares {#sec:chi2}" href="leastSquares.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Methods and Data Analysis Techniques</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="probability.html">
   Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="probabilityDistributions.html">
   Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="errors.html">
   Measurements uncertainties {#ch:errors}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monteCarlo.html">
   Monte Carlo methods {#sec:MC}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inference.html">
   Statistical inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood.html">
   Parameter Estimation - Likelihood  {#ChapterParameterEstimations}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="leastSquares.html">
   Parameter Estimation - Least Squares {#sec:chi2}
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hypotheses Testing {#ChapterHypothesisTesting}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="confidenceIntervals.html">
   Confidence Intervals {#ChapterConfidenceLimits}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mva.html">
   Multivariate Analysis Methods {#ChapterMVA}
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="unfolding.html">
   Unfolding {#ch:Unfolding}
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/hypothesisTesting.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hypotheses-and-tests-statistics">
   Hypotheses and tests statistics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#significance-power-consistency-and-bias">
   Significance, power, consistency and bias
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#is-there-a-signal">
   Is there a signal ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neyman-pearson-lemma-sectionneymanpearson">
   Neyman Pearson Lemma {#SectionNeymanPearson}
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goodness-of-fit-sectiongoodnessoffit">
   Goodness of Fit {#SectionGoodnessOfFit}
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-chi-2-test">
     The
     <span class="math notranslate nohighlight">
      \(\chi^2\)
     </span>
     -Test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degrees-of-freedom-for-chi-2-test-on-fitted-data">
     Degrees of freedom for
     <span class="math notranslate nohighlight">
      \(\chi^2\)
     </span>
     -test on fitted data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-test">
     Run test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unbinned-tests-sec-ks">
   Unbinned tests {#sec:KS}
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-sample-problem-sectiondistributiondependingtests">
   Two-sample problem {#SectionDistributionDependingTests}
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-gaussians-known-sigma-sec-knownsigma">
     Two Gaussians, known
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     {#sec:knownsigma}
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-gaussians-unknown-sigma-student-t">
     Two Gaussians, unknown
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     {#student-t}
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f-test-sec-ftest">
     F-test {#sec:Ftest}
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matched-and-correlated-samples">
     Matched and correlated samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-most-general-test">
     The most general test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anova">
   ANOVA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resampling-techniques-sec-resampling">
   Resampling techniques {#sec:resampling}
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jackknife">
     Jackknife
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bootstrap">
     Bootstrap
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="hypotheses-testing-chapterhypothesistesting">
<h1>Hypotheses Testing {#ChapterHypothesisTesting}<a class="headerlink" href="#hypotheses-testing-chapterhypothesistesting" title="Permalink to this headline">¶</a></h1>
<p>In the previous chapters we used experimental data to estimate
parameters. Here we will use data to test hypotheses. A typical example
is to test whether the data are compatible with the theoretical
prediction or to choose among different hypothesis which one best
represents the data.</p>
<div class="section" id="hypotheses-and-tests-statistics">
<h2>Hypotheses and tests statistics<a class="headerlink" href="#hypotheses-and-tests-statistics" title="Permalink to this headline">¶</a></h2>
<p>Let’s begin by defining some terminology that we will need in the
following. The goal of a statistical test is to make a statement about
how well the observed data stand in agreement (accept) or not (reject)
with a given predicted distribution, i.e. a hypothesis. The typical
naming for the hypothesis under test is the <strong>null hypothesis</strong> or
<span class="math notranslate nohighlight">\(H_{0}\)</span>. The <strong>alternative hypothesis</strong>, if there is one, is usually
called <span class="math notranslate nohighlight">\(H_{1}\)</span>. If there are several alternative hypotheses they are
labeled <span class="math notranslate nohighlight">\(H_{1}, H_{2}, \ldots\)</span> The hypothesis can be <strong>simple</strong> if the
p.d.f. of the random variable under test is completely specified (e.g.
the data are drawn from a Gaussian p.d.f. with specified normalization,
mean ad width) or <strong>composite</strong> if at least one of the parameters is not
specified (e.g. the data are drawn from a Poisson with mean <span class="math notranslate nohighlight">\(&gt;\)</span>3).<br />
In order to tell in a quantitative way what it means to <em>test a
hypothesis</em> we need to build a function of the measured variables
<span class="math notranslate nohighlight">\(\vec{x}\)</span>, called <em>test statistic</em> <span class="math notranslate nohighlight">\(t(\vec{x})\)</span>. If we build it in a
clever way, the test statistic will be distributed differently depending
on the hypothesis under test: <span class="math notranslate nohighlight">\(g(t(\vec{x})|H_0)\)</span> or
<span class="math notranslate nohighlight">\(g(t(\vec{x})|H_1)\)</span>. This pedantic notation is used here to stress that
the test statistic is a function of the data and that it is the
distribution of the test statistic values that is different under the
different hypotheses (the lighter notation <span class="math notranslate nohighlight">\(g(t|H_i)\)</span> will be used from
now on). Comparing the value of the test statistic computed on the
actual data, with the value(s) obtained computing it under different
hypotheses, we can quantitatively state the level of agreement. That’s
the general idea. The way this is implemented in practice will be
explained in the next sections.<br />
The test statistic can be any function of the data: it can be a
multidimensional vector <span class="math notranslate nohighlight">\(\vec{t}(\vec{x})\)</span> or a single real number
<span class="math notranslate nohighlight">\(t(\vec{x})\)</span>. Even the data themselves <span class="math notranslate nohighlight">\(\{\vec{x}\}\)</span> can be used as a
test statistic. Collapsing all the information about the data into a
single meaningful variable is particularly helpful in visualizing the
test statistic and the separation between the two hypothesis. There is
no general rule about the choice of the test statistic. The specific
choice will depend on the particular case at hand. Different test
statistic will give in general different results and it is up to the
physicist to decide which is the most appropriate for the specific
problem.<br />
<br />
<strong>Example</strong>: In order to better understand the terminology we can use a
specific example based on particle identification. The average specific
ionization <span class="math notranslate nohighlight">\(dE/dx\)</span> of two charged particle with the same momentum
passing through matter will be different depending on their masses (see
Fig. <a class="reference external" href="#fig:dEdx">1.2</a>{reference-type=”ref” reference=”fig:dEdx”},
<span class="math notranslate nohighlight">\(\beta\gamma = p / m\)</span>). Because of this dependence <span class="math notranslate nohighlight">\(dE/dx\)</span> can be used
as a particle identification tool to distinguish particle types. For
example the ionization of electrons with momenta in the range of few GeV
tend to be larger than the one of pions of the same momentum range.</p>
<p><img alt="Left: the specific ionization for some particle types (in green pionsand in red electrons; other particles species are shown with differentcolors); Right: the projections of the left plot on the y-axis, i.e. themeasured specific ionization for pions andelectrons." src="Section8Bilder/BetheBloch.png" />{#fig:dEdx
width=”\textwidth”}</p>
<p><img alt="Left: the specific ionization for some particle types (in green pionsand in red electrons; other particles species are shown with differentcolors); Right: the projections of the left plot on the y-axis, i.e. themeasured specific ionization for pions andelectrons." src="Section8Bilder/BetheBlochProjection.png" />{#fig:dEdx
width=”\textwidth”}</p>
<p>If we want to distinguish an electron from a pion with a given momentum
we can use the specific ionization itself as test statistic
<span class="math notranslate nohighlight">\(t(\vec{x}) = dE/dx\)</span>. This is a typical case where the data itself is
used as test statistic. The test statistics will then be distributed
differently under the two following hypotheses (see
Fig. <a class="reference external" href="#fig:dEdx">1.2</a>{reference-type=”ref” reference=”fig:dEdx”} right):</p>
<ul class="simple">
<li><p>null hypothesis <span class="math notranslate nohighlight">\(g(t|H_0) = P\left(\frac{dE}{dx}|e^{\pm}\right)\)</span></p></li>
<li><p>alternative hypothesis
<span class="math notranslate nohighlight">\(g(t|H_1) = P\left(\frac{dE}{dx}|\pi^{\pm}\right)\)</span></p></li>
</ul>
<p><br />
<strong>Example</strong>: When testing data for the presence of a signal, we define
the null hypothesis as the “background only” hypothesis and the
alternative hypothesis as the “signal+background” hypothesis.<br />
<strong>Example</strong>: Fig. <a class="reference external" href="#fig:L3SM">1.3</a>{reference-type=”ref”
reference=”fig:L3SM”} shows the cross section
<span class="math notranslate nohighlight">\(\sigma(e^+e^-)\to W^+W^-(\gamma)\)</span> measured by the L3 collaboration at
different centre of mass energies. In this case the test statistic is
the cross-section as a function of energy. The measured values are then
compared with different theoretical models (different hypothesis). We
haven’t explained yet how to quantitatively accept or reject an
hypothesis, but already at a naive level we can see that data clearly
prefer one of the models.</p>
<p><img alt="Analysis of the cross section of  as afunction of the centre of mass energy (L3 detector at LEP)." src="Section8Bilder/L3SM.png" />{#fig:L3SM width=”\textwidth”}</p>
<p><br />
<br />
The p.d.f. describing the test statistic corresponding to a certain
hypothesis <span class="math notranslate nohighlight">\(g(\vec{t}|H)\)</span> is usually built from a data set that has
precisely the characteristic associated to that hypothesis. In the
particle identification example discussed before, the expected data used
to build the p.d.f. for the two hypotheses were pure sample of electrons
and pure samples of pions. For example you can get a pure sample of
electrons selecting tracks from photon conversions <span class="math notranslate nohighlight">\(\gamma \to e^+ e^-\)</span>
and a pure sample of pions from the self-tagging decays of charmed
mesons
<span class="math notranslate nohighlight">\(D^{*+}\to \pi^+ D^0; D^0\to K^- \pi^+ (D^{*-}\to \pi^- D^0; D^0\to K^+ \pi^-)\)</span>
(self-tagging means that by knowing the charge of the <span class="math notranslate nohighlight">\(\pi\)</span> in the first
decay you can unambiguously assign the pion/kaon hypothesis to the
positive/negative charge of the second decay). In other cases the p.d.f.
are built from dedicated measurement (e.g. a test beam<a class="footnote-reference brackets" href="#id5" id="id1">1</a>) or from
Monte Carlo simulations.\</p>
</div>
<div class="section" id="significance-power-consistency-and-bias">
<h2>Significance, power, consistency and bias<a class="headerlink" href="#significance-power-consistency-and-bias" title="Permalink to this headline">¶</a></h2>
<p>In order to accept or reject a null hypothesis we partition the space of
the test statistics values into a <strong>critical region</strong> and its
complementary the <strong>acceptance region</strong> (see
Fig. <a class="reference external" href="#fig:acceptReject">1.4</a>{reference-type=”ref”
reference=”fig:acceptReject”}). The value of the test statistics chosen
to define the two regions is called <strong>decision boundary</strong>: “<span class="math notranslate nohighlight">\(t_{cut}\)</span>”.
If the value of the test statistic computed on the data sample under
test falls in the rejection region, then the null hypothesis is
discarded, otherwise it is accepted (or more precisely not rejected).</p>
<p><img alt="[[fig:acceptReject]]{#fig:acceptReject label=&quot;fig:acceptReject&quot;}Atest statistic in red, where we defined an acceptance  andrejection region." src="Section8Bilder/acceptReject.png" />{#fig:acceptReject width=”40%”}</p>
<p>Given a test statistic, some parameters are usually defined when sizing
a rejection region. The first one is the <strong>significance level</strong> of the
test (see Fig. <a class="reference external" href="#AcceptRejectRegions">1.6</a>{reference-type=”ref”
reference=”AcceptRejectRegions”}). It is defined as the integral of the
null hypothesis p.d.f. above the decision boundary:
$<span class="math notranslate nohighlight">\(\alpha = \int_{t_{cut}}^\infty g(t|H_0)dt\)</span><span class="math notranslate nohighlight">\( The probability \)</span>\alpha<span class="math notranslate nohighlight">\(
can be read as the probability to reject \)</span>H_0<span class="math notranslate nohighlight">\( even if \)</span>H_0<span class="math notranslate nohighlight">\( is in
reality correct. This is called an **error of the first kind**.\
If we have an alternative hypothesis \)</span>H_1<span class="math notranslate nohighlight">\(, an error of the **second
kind** occurs when \)</span>H_0<span class="math notranslate nohighlight">\( is accepted but the correct hypothesis is in
reality the alternative one \)</span>H_1<span class="math notranslate nohighlight">\(. The integral of the alternative
hypothesis p.d.f. below \)</span>t_{cut}<span class="math notranslate nohighlight">\( is called the **power of the test** to
discriminate against the alternative hypothesis \)</span>H_1<span class="math notranslate nohighlight">\( (see
Fig. [1.6](#AcceptRejectRegions){reference-type=&quot;ref&quot;
reference=&quot;AcceptRejectRegions&quot;}):
\)</span><span class="math notranslate nohighlight">\(\beta = \int_{-\infty}^{t_{cut}} g(t|H_1)dt\)</span>$</p>
<p><img alt="Illustration of the acceptance and rejection region both for thehypothesis  (on the left hand side) and the alternative (on the right hand side) under the same choice of decisionboundary." src="Section8Bilder/nullHP.png" />{#AcceptRejectRegions
width=”\textwidth”}</p>
<p><img alt="Illustration of the acceptance and rejection region both for thehypothesis  (on the left hand side) and the alternative (on the right hand side) under the same choice of decisionboundary." src="Section8Bilder/alternativeHP.png" />{#AcceptRejectRegions
width=”\textwidth”}</p>
<p>A good test has both <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> small, which is equivalent to
say high significance and high power. This means that <span class="math notranslate nohighlight">\(H_{0}\)</span> and
<span class="math notranslate nohighlight">\(H_{1}\)</span> are <em>well separated</em>.
Tab. <a class="reference external" href="#tab:typeErrors">1.7</a>{reference-type=”ref”
reference=”tab:typeErrors”} summarize the different ways to mistakenly
interpret the data in terms of errors of the first and second kind.
While errors of the first type can be controlled by choosing <span class="math notranslate nohighlight">\(\alpha\)</span>
sufficiently small, errors of the second type, depending on the
separation between the two hypothesis, are not as easily controllable.
In HEP searches we typically speak of “evidence” when
<span class="math notranslate nohighlight">\(\alpha \leq 3\cdot 10^{-3}\)</span>, and of “discovery” when
<span class="math notranslate nohighlight">\(\alpha \leq 3\cdot 10^{-7}\)</span> (corresponding to the probability outside 3
<span class="math notranslate nohighlight">\(\sigma\)</span> and 5 <span class="math notranslate nohighlight">\(\sigma\)</span> respectively in a single sided tail Gaussian);
these numbers are purely conventional and they don’t have any scientific
ground. They are defined this way to set a high threshold for such
important claims about the observation of new phenomena.<a class="footnote-reference brackets" href="#id6" id="id2">2</a>\</p>
<p><img alt="Example of errors of the first and second kind(Wikipedia)." src="Section8Bilder/Type1Type2.png" />{#tab:typeErrors
width=”\textwidth”}</p>
<p><br />
<br />
<strong>Example</strong>  Consider a machine BM1 which is used for bonding wires of
Si-detector modules. The produced detectors had a scrap rate of
<span class="math notranslate nohighlight">\(P_{0} = 0.2\)</span>. BM1 should be replaced with a newer bonding machine
called BM2, if (and only if) the new machine can produce detector
modules with a lower scrap rate <span class="math notranslate nohighlight">\(P_{1}\)</span>. In a test run we produce <span class="math notranslate nohighlight">\(n=30\)</span>
modules. To verify <span class="math notranslate nohighlight">\(P_{1} &lt; P_{0}\)</span> statistically, we use the hypothesis
test discussed above. Define the two hypotheses <span class="math notranslate nohighlight">\(H_{0}\)</span> and <span class="math notranslate nohighlight">\(H_{1}\)</span> as:
$<span class="math notranslate nohighlight">\(H_{0} : P_{1} \geq 0.2; \quad H_{1}: P_{1} &lt; 0.2.\)</span><span class="math notranslate nohighlight">\( We choose
\)</span>\alpha = 0.05<span class="math notranslate nohighlight">\( and our test statistic \)</span>t<span class="math notranslate nohighlight">\( is the number of
malfunctioning detector modules. This quantity is distributed according
to a binomial distribution, with the total number of produced modules
\)</span>n=30<span class="math notranslate nohighlight">\( and a probability \)</span>P<span class="math notranslate nohighlight">\(. The rejection region for \)</span>H_{0}<span class="math notranslate nohighlight">\( is
constructed out of
\)</span><span class="math notranslate nohighlight">\(\sum_{i=0}^{n_c}{n \choose i}P_0^i(1-P_0)^{n-i}&lt;\alpha.\)</span><span class="math notranslate nohighlight">\( Here, the
critical value is denoted by \)</span>n_{c}<span class="math notranslate nohighlight">\(, and it is the maximal number of
malfunctioning modules produced by BM2 which still implies a rejection
of \)</span>H_{0}<span class="math notranslate nohighlight">\( with CL \)</span>1-\alpha<span class="math notranslate nohighlight">\(. By going through the calculation we find
that for \)</span>n_{c} =2<span class="math notranslate nohighlight">\( the value of \)</span>\alpha<span class="math notranslate nohighlight">\( is still just below 0.05. This
means that if we find two or less malfunctioning modules produced by BM2
we should replace BM1 by the new machine BM2.\
\
Once the test statistics is defined there is a trade-off between
\)</span>\alpha<span class="math notranslate nohighlight">\( and \)</span>\beta<span class="math notranslate nohighlight">\(, the smaller you make \)</span>\alpha<span class="math notranslate nohighlight">\( the larger \)</span>\beta<span class="math notranslate nohighlight">\(
will be; it's up to the experimenter to decide what is acceptable and
what is not.\
\
**Example** Suppose we want to distinguish \)</span>K-p<span class="math notranslate nohighlight">\( elastic scattering
events from inelastic scattering events where a \)</span>\pi^0<span class="math notranslate nohighlight">\( is produced.
\)</span>H_0 : K^- p \to K^- p<span class="math notranslate nohighlight">\( ; \)</span>H_1 : K^- p \to K^- p \pi^0<span class="math notranslate nohighlight">\(. The detector
used for this experiment is a spectrometer capable of measuring the
momenta of all the charged particles (\)</span>K^-<span class="math notranslate nohighlight">\(, \)</span>p<span class="math notranslate nohighlight">\() but it is blind to
neutral particles (\)</span>\pi^0<span class="math notranslate nohighlight">\(). The considered test statistic is the
&quot;missing mass&quot; \)</span>M<span class="math notranslate nohighlight">\( defined as the difference between the initial and
final visible mass. The true value of the missing mass is \)</span>M=0<span class="math notranslate nohighlight">\( under
the null hypothesis \)</span>H_0<span class="math notranslate nohighlight">\( (no \)</span>\pi^0<span class="math notranslate nohighlight">\( produced) and
\)</span>M_{\pi^0}=135~MeV/c^2<span class="math notranslate nohighlight">\( under the alternative hypothesis \)</span>H_1<span class="math notranslate nohighlight">\( (a
\)</span>\pi^0<span class="math notranslate nohighlight">\( is produced). The critical region can be defined as \)</span>M&gt;M_c<span class="math notranslate nohighlight">\(. The
value of \)</span>M_c<span class="math notranslate nohighlight">\( depends on the significance and power we want to obtain
(see Fig. [1.8](#fig:inelastic){reference-type=&quot;ref&quot;
reference=&quot;fig:inelastic&quot;}): a high value of \)</span>M_c<span class="math notranslate nohighlight">\( will correspond to a
high significance at the expenses of the power, while low values of
\)</span>M_c$ will result in a high power but low significance.<br />
\</p>
<p><img alt="Top: the p.d.f. for the test statistic  under the null hypothesisof elastic scattering  centred at ; bottom the p.d.f. for thetest statistic under the alternative hypothesis of inelastic scattering centred at .  defines the criticalregion." src="Section8Bilder/inelastic.png" />{#fig:inelastic
width=”\textwidth”}</p>
<p><br />
Some caution is necessary when using <span class="math notranslate nohighlight">\(\alpha\)</span>. Suppose you have 20
researchers looking for a new phenomenon which “in reality” does not
exist. Their <span class="math notranslate nohighlight">\(H_0\)</span> hypothesis is that what they see is only background.
One of them could reject <span class="math notranslate nohighlight">\(H_0\)</span> with <span class="math notranslate nohighlight">\(\alpha = 5\%\)</span>, while the other 19
will not. This is part of the game and therefore, before rushing for
publication, that researcher should balance the claim with what the
others don’t see. That’s the main reason why anytime there is a
discovery claim, we always need to have the results to be corroborated
by independent measurements. We will come back to this point when we
will talk about the look-elsewhere effect.<br />
<br />
<strong>Example</strong>  Let’s use again the example of the electron/pion
separation. As already shown before the specific ionization <span class="math notranslate nohighlight">\(dE/dx\)</span> of a
charged particle can be used as a test statistic to distinguish particle
types, for example electrons (<span class="math notranslate nohighlight">\(e\)</span>) from pions (<span class="math notranslate nohighlight">\(\pi\)</span>)(see
Fig. <a class="reference external" href="#fig:dEdx">1.2</a>{reference-type=”ref” reference=”fig:dEdx”}). The
selection efficiency is defined as the probability for a particle to
pass the selection cut:
$<span class="math notranslate nohighlight">\(\epsilon_e = \int_{-\infty}^{t_{cut}}g(t|e) dt = 1-\alpha \qquad  \epsilon_\pi = \int_{-\infty}^{t_{cut}}g(t|\pi) dt = \beta\)</span><span class="math notranslate nohighlight">\(
By moving the value of \)</span>t_{cut}<span class="math notranslate nohighlight">\( you can change the composition of your
sample. The lower the value of \)</span>t_{cut}<span class="math notranslate nohighlight">\( the larger the electron
efficiency but the higher the contamination from pions and vice-versa.
In general, one can set a value of \)</span>t_{cut}<span class="math notranslate nohighlight">\(, select a sample and work
out what is the fraction of electrons \)</span>N_{acc}<span class="math notranslate nohighlight">\( present in the initial
sample (before the requirement \)</span>t&lt;t_{cut}<span class="math notranslate nohighlight">\(). The number of accepted
particles in the sample is composed by:
\)</span><span class="math notranslate nohighlight">\(N_{acc}=\epsilon_e N_e + \epsilon_\pi N_\pi = \epsilon_e N_e + \epsilon_\pi(N_{tot} - N_e)\)</span><span class="math notranslate nohighlight">\(
which gives
\)</span><span class="math notranslate nohighlight">\(N_{e}=\frac{N_{acc} - \epsilon_\pi N_{tot}}{\epsilon_e - \epsilon_\pi}\)</span><span class="math notranslate nohighlight">\(
From this, one can immediately notice that the \)</span>N_e<span class="math notranslate nohighlight">\( can only be
calculated if \)</span>\epsilon_e \neq \epsilon_\pi<span class="math notranslate nohighlight">\(, i.e. \)</span>N_e<span class="math notranslate nohighlight">\( can only be
extracted if there is any separation power at all. If there are
systematic uncertainties in \)</span>\epsilon_e<span class="math notranslate nohighlight">\( or \)</span>\epsilon_\pi<span class="math notranslate nohighlight">\( these will
translate into an uncertainty on \)</span>N_e<span class="math notranslate nohighlight">\(. One should try to select the
critical region \)</span>t_{cut}<span class="math notranslate nohighlight">\( such that the total error on \)</span>N_e<span class="math notranslate nohighlight">\( is
negligible.\
The other side of the problem is to estimate the **purity** \)</span>p_e<span class="math notranslate nohighlight">\( of the
sample of candidates passing the requirement \)</span>t&lt;t_{cut}<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(\begin{aligned}
p_e &amp;=&amp; \frac{\#electrons~with~t&lt;t_{cut}}{\#particles~with~t&lt;t_{cut}}\\
    &amp;=&amp; \frac{\int_{-\infty}^{t_{cut}}a_e g(t|e) dt }{\int_{-\infty}^{t_{cut}}(a_e g(t|e) + (1-a_e)g(t|\pi) ) dt }\\
    &amp;=&amp; \frac{a_e\epsilon_e N_{tot}}{N_{acc}}\end{aligned}\)</span>$<br />
Historically, in high energy physics a parallel nomenclature has been
defined to express the same concepts we have encounter in this section:</p>
<ul class="simple">
<li><p><em>signal efficiency</em> = 1-<span class="math notranslate nohighlight">\(\alpha\)</span> (a test is significant at a level
1-<span class="math notranslate nohighlight">\(\alpha\)</span> %)</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> = probability of a type I error</p></li>
</ul>
</li>
<li><p><em>background efficiency</em> = <span class="math notranslate nohighlight">\(\beta\)</span> = probability of a type II error</p>
<ul>
<li><p>1-<span class="math notranslate nohighlight">\(\beta\)</span> = power of the test = background rejection</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="is-there-a-signal">
<h2>Is there a signal ?<a class="headerlink" href="#is-there-a-signal" title="Permalink to this headline">¶</a></h2>
<p>A typical application of hypothesis testing in high energy physics is to
test for the presence of a signal in data. The easiest case is
represented by counting experiments. In this type of experiments the
detector is used to count the number of events satisfying some selection
criteria (slang: “cut-and-count”). The number of expected events in case
of background only hypothesis is compared with the measured number. The
signal would typically appear as an excess over the expected
background<a class="footnote-reference brackets" href="#id7" id="id3">3</a>.<br />
<br />
<strong>Example</strong> Let <span class="math notranslate nohighlight">\(n\)</span> be a number of events which is the sum of some
signal and some background events <span class="math notranslate nohighlight">\(n = n_s + n_b\)</span>. Each of the
components can be treated as a Poisson variable <span class="math notranslate nohighlight">\(\nu_s\)</span> (signal) and
<span class="math notranslate nohighlight">\(\nu_b\)</span> (background) and so the total <span class="math notranslate nohighlight">\(\nu = \nu_s + \nu_b\)</span> is also a
Poisson variable. The probability to observe <span class="math notranslate nohighlight">\(n\)</span> events is:
$<span class="math notranslate nohighlight">\(f(n; \nu_s, \nu_b) = \frac{(\nu_s+\nu_b)^n}{n!}e^{-(\nu_s+\nu_b)}\)</span><span class="math notranslate nohighlight">\(
Suppose you measure \)</span>n_{obs}<span class="math notranslate nohighlight">\( events. To quantify our degree of
confidence in the discovery of a new phenomenon, i.e. \)</span>\nu_s\ne 0<span class="math notranslate nohighlight">\(, we
can compute *how likely it is to find \)</span>n_{obs}<span class="math notranslate nohighlight">\( events or more from
background alone*.
\)</span><span class="math notranslate nohighlight">\(P(n\ge n_{obs}) = \sum_{n=n_{obs}}^\infty f(n; \nu_s = 0, \nu_b) = 1 - \sum_{n=0}^{n_{obs}-1} f(n; \nu_s = 0, \nu_b) =
1- \sum_{n=0}^{n_{obs}-1} \frac{\nu_b^n}{n!}e^{-\nu_b}.\)</span><span class="math notranslate nohighlight">\( For example,
if we expect \)</span>\nu_b = 0.5<span class="math notranslate nohighlight">\( background events and we observe
\)</span>n_{obs} = 5<span class="math notranslate nohighlight">\(, then the *p*-value is \)</span>1.7 \cdot 10^{-4}<span class="math notranslate nohighlight">\(. *This is not
the probability of the hypothesis \)</span>\nu_s = 0<span class="math notranslate nohighlight">\( ! It is rather the
probability, under the assumption \)</span>\nu_s = 0<span class="math notranslate nohighlight">\(, of obtaining as many
events as observed or more.*\
You should be very careful with a common pitfall. Often the result of a
measurement is given as the estimated value of a number of events plus
or minus one standard deviation. Since the standard deviation of a
Poisson variable is equal to the square root of its mean, from the
previous example, we have \)</span>5 \pm \sqrt{5}<span class="math notranslate nohighlight">\( for an estimate of \)</span>\nu<span class="math notranslate nohighlight">\(,
i.e. after subtracting the expected background, \)</span>4.5 \pm 2.2<span class="math notranslate nohighlight">\( for our
estimate of \)</span>\nu_s<span class="math notranslate nohighlight">\(. This is very misleading: it is only two standard
deviations from zero, and it gives the impression that \)</span>\nu_s<span class="math notranslate nohighlight">\( is not
very incompatible with zero, but we have seen from the *p*-value that it
is not the case. The subtlety is that we need to ask for the probability
that a Poisson variable of mean \)</span>\nu_b<span class="math notranslate nohighlight">\( will fluctuate up to \)</span>n_{obs}<span class="math notranslate nohighlight">\(
or higher, not for the probability that a Poisson variable with mean
\)</span>n_{obs}<span class="math notranslate nohighlight">\( will fluctuate down to \)</span>\nu_b<span class="math notranslate nohighlight">\( or lower.\
Another important point is that usually \)</span>\nu_b<span class="math notranslate nohighlight">\( is known within some
uncertainty. If we set \)</span>\nu = 0.8<span class="math notranslate nohighlight">\( rather than 0.5, the *p*-value would
increase by almost an order of magnitude to \)</span>1.4 \cdot 10^{-3}$. It is
therefore crucial to quantify the systematic uncertainty of the
background when evaluating the significance of a new effect.<br />
<br />
In other types of searches the signal would reveal itself as a
resonance, i.e. an excess of data in a localized region of a mass
spectrum (slang: “bump hunt”), or as an excess of events in the tail of
a distribution. Two examples are show in
Fig. <a class="reference external" href="#fig:searches">1.9</a>{reference-type=”ref”
reference=”fig:searches”}. In these cases the signal is extracted from
the background using a fit (more on this will be developed in the next
sections). In this case on top of using the number of expected events,
we add the information about the way they are distributed (slang: “shape
analysis”).</p>
<p><img alt="Left: Higgs boson search in 2011. Right: search for an excess ofevents at high missing transverse energy. In both cases the data arewell described by the background onlyhypothesis." src="Section8Bilder/searches.png" />{#fig:searches
width=”\textwidth”}</p>
<p><br />
\</p>
</div>
<div class="section" id="neyman-pearson-lemma-sectionneymanpearson">
<h2>Neyman Pearson Lemma {#SectionNeymanPearson}<a class="headerlink" href="#neyman-pearson-lemma-sectionneymanpearson" title="Permalink to this headline">¶</a></h2>
<p>We haven’t addressed up to now the choice of <span class="math notranslate nohighlight">\(t_{cut}\)</span>. The only thing
we know up to now is that it affects the efficiency and the purity of
the sample under study. Ideally what we want is to set the desired
efficiency and for that value get the best possible purity.<br />
Take the case of a <em>simple hypothesis</em> <span class="math notranslate nohighlight">\(H_0\)</span> and allow for an
alternative <em>simple hypothesis</em> <span class="math notranslate nohighlight">\(H_1\)</span> (e.g. the typical situation of
signal and background). The <em>Neyman Pearson lemma</em> states that the
acceptance region giving the highest power (i.e. the highest purity) for
a given significance level <span class="math notranslate nohighlight">\(\alpha\)</span>, is the region of space such that:
$<span class="math notranslate nohighlight">\(\frac{g(\vec{t} | H_{0})}{g(\vec{t} | H_{1})} &gt; c,\)</span><span class="math notranslate nohighlight">\( where \)</span>c<span class="math notranslate nohighlight">\( is the
knob we can tune to achieve the desired efficiency and
\)</span>g(\vec{t}|H_{i})<span class="math notranslate nohighlight">\( is the distribution of \)</span>\vec{t}<span class="math notranslate nohighlight">\( under the hypothesis
\)</span>H_{i}<span class="math notranslate nohighlight">\(.\
Basically what the lemma says is that there is function \)</span>r<span class="math notranslate nohighlight">\( defined as
\)</span><span class="math notranslate nohighlight">\(\begin{aligned}
r = \frac{g(\vec{t} | H_{0})}{g(\vec{t} | H_{1})}\end{aligned}\)</span><span class="math notranslate nohighlight">\( that
brings the problem to a 1 dimensional case and that gives the best
purity given a fixed efficiency. The function \)</span>r<span class="math notranslate nohighlight">\( is called the
*likelihood ratio* for the simple hypotheses \)</span>H_0<span class="math notranslate nohighlight">\( and \)</span>H_1<span class="math notranslate nohighlight">\( (in the
likelihood the data are fixed, the hypothesis is what is changed). The
corresponding acceptance region is given by \)</span>r&gt;c<span class="math notranslate nohighlight">\(. Any monotonic
function of \)</span>r<span class="math notranslate nohighlight">\( will be good too and will lead to the same test.\
The main draw back of the Neyman-Pearson lemma is that is is valid if
and only if both \)</span>H_0<span class="math notranslate nohighlight">\( and \)</span>H_1<span class="math notranslate nohighlight">\( are simple hypothesis (and that is
pretty rare). Even in those cases in order to determine c one needs to
know \)</span>g(\textbf{t}|H_{0})<span class="math notranslate nohighlight">\( and \)</span>g(\textbf{t}| H_{1})<span class="math notranslate nohighlight">\(. These have to be
determined by Monte Carlo simulations, or data driven techniques, for
both data and background. The simplest way to represent the p.d.f.'s is
to use a multidimensional histogram. This can cause some troubles when
the dimensionality of the problems is high. Say we have \)</span>M<span class="math notranslate nohighlight">\( bins for
each of the \)</span>n<span class="math notranslate nohighlight">\( dimension of the test statistics \)</span>\textbf{t}<span class="math notranslate nohighlight">\(, then the
total number of bins is \)</span>M^n<span class="math notranslate nohighlight">\(, i.e. \)</span>M^n$, parameters must be determined
from Monte Carlo or data and this can quickly become impractical. We
will see later (Ch. <a class="reference external" href="#ChapterMVA">[ChapterMVA]</a>{reference-type=”ref”
reference=”ChapterMVA”}) a different way to model the p.d.f. using
Multi-Variate techniques.</p>
</div>
<div class="section" id="goodness-of-fit-sectiongoodnessoffit">
<h2>Goodness of Fit {#SectionGoodnessOfFit}<a class="headerlink" href="#goodness-of-fit-sectiongoodnessoffit" title="Permalink to this headline">¶</a></h2>
<p>A typical application of hypothesis testing is to assess the goodness of
a fit, i.e. quantifying how well the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> describes a
sample of data, <em>without any specific reference to an alternative
hypothesis</em>. The test statistic has to be constructed such that it
reflects the level of agreement between the observed data and the
predictions of <span class="math notranslate nohighlight">\(H_0\)</span>.<br />
The typical quantitative way to assess the agreement is to use the
concept of <span class="math notranslate nohighlight">\(p-\)</span>value. As we have already seen
(Eq. <a class="reference external" href="#eq:pvalue">[eq:pvalue]</a>{reference-type=”ref”
reference=”eq:pvalue”}) the <span class="math notranslate nohighlight">\(p-\)</span>value is the probability, under the
assumption of H, to observe data with equal or less compatibility with
<span class="math notranslate nohighlight">\(H_0\)</span>, relative to the data we got.<br />
N.B.: the <span class="math notranslate nohighlight">\(p-\)</span>value does not give the probability for <span class="math notranslate nohighlight">\(H_0\)</span> to be true!
As a frequentist the probability of the hypothesis is not even defined:
the probability is defined on the data. As Bayesian the probability of
the hypothesis is a different thing and it is defined through the Bayes
theorem using the prior hypothesis.</p>
<div class="section" id="the-chi-2-test">
<h3>The <span class="math notranslate nohighlight">\(\chi^2\)</span>-Test<a class="headerlink" href="#the-chi-2-test" title="Permalink to this headline">¶</a></h3>
<p>We have already encountered the <span class="math notranslate nohighlight">\(\chi^2\)</span> as a goodness of fit test in
section
Sec. <a class="reference external" href="#sec:chi2GoodnessOfFit">[sec:chi2GoodnessOfFit]</a>{reference-type=”ref”
reference=”sec:chi2GoodnessOfFit”}. The <span class="math notranslate nohighlight">\(\chi^{2}\)</span>-test is by far the
most commonly used goodness of fit test. The first application we
discuss is with a set of measurements <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span>, where the <span class="math notranslate nohighlight">\(x_i\)</span>
are supposed to be exact (or at least with negligible uncertainty) and
the <span class="math notranslate nohighlight">\(y_i\)</span> are known with an uncertainty <span class="math notranslate nohighlight">\(\sigma_i\)</span>. We want to test the
function <span class="math notranslate nohighlight">\(f(x)\)</span> which we believe it gives (predicts) the correct value
of <span class="math notranslate nohighlight">\(y_i\)</span> for each value of <span class="math notranslate nohighlight">\(x_i\)</span>; to do so we define the <span class="math notranslate nohighlight">\(\chi^2\)</span> as:
$<span class="math notranslate nohighlight">\(\chi^{2} = \sum_{i=1}^{N} \frac{[y_{i}-f(x_{i})]^{2}}{\sigma_{i}^{2}}.\)</span><span class="math notranslate nohighlight">\(
If the uncertainties on the \)</span>y_i<span class="math notranslate nohighlight">\( measurements are correlated, the above
formula becomes (with the lighter matrix notation, see
Sec. [\[sec:matrixNotation\]](#sec:matrixNotation){reference-type=&quot;ref&quot;
reference=&quot;sec:matrixNotation&quot;}):
\)</span><span class="math notranslate nohighlight">\(\chi^{2} = (\bf{y}-\bf{f})^T \bf{V}^{-1} (\bf{y} - \bf{f})\)</span><span class="math notranslate nohighlight">\( where
\)</span>\bf{V}<span class="math notranslate nohighlight">\( is the covariance matrix. A function that correctly describes
the data will give a small difference between the values predicted by
the function \)</span>f<span class="math notranslate nohighlight">\( and the measurements \)</span>y_i<span class="math notranslate nohighlight">\(. This difference reflects
the statistical uncertainty on the measurements, so for \)</span>N<span class="math notranslate nohighlight">\( measurements
the \)</span>\chi^2<span class="math notranslate nohighlight">\( should be roughly \)</span>N<span class="math notranslate nohighlight">\(.\
Recalling the p.d.f. of the \)</span>\chi^2<span class="math notranslate nohighlight">\( distribution (see
Sec. [\[SubSectionChi2\]](#SubSectionChi2){reference-type=&quot;ref&quot;
reference=&quot;SubSectionChi2&quot;}): \)</span><span class="math notranslate nohighlight">\(\label{Chi2EquationAgain}
  P(\chi^{2};N) = \frac{2^{\frac{-N}{2}}}{\Gamma(\frac{N}{2})} \chi^{N-2} e ^{\frac{-\chi^{2}}{2}}\)</span><span class="math notranslate nohighlight">\(
(where the expectation value of this distribution is \)</span>N<span class="math notranslate nohighlight">\(, and so
\)</span>\chi^{2} / N \sim 1<span class="math notranslate nohighlight">\(), we can base our *decision boundary* on the
goodness-of-fit, by defining the \)</span>p-<span class="math notranslate nohighlight">\(value: \)</span><span class="math notranslate nohighlight">\(\label{Chi2Probability}
  p = \text{Prob}(\chi^{2};N) = \int_{\chi^{2}}^{\infty} P(\chi'^{2}; N) d\chi'^{2}\)</span><span class="math notranslate nohighlight">\(
which is called the *\)</span>\chi^{2}<span class="math notranslate nohighlight">\( probability*. This expression gives the
probability that the function describing the \)</span>N<span class="math notranslate nohighlight">\( measured data points
gives a \)</span>\chi^{2}<span class="math notranslate nohighlight">\( *as large or larger than* the one we obtained from
our measurement.\
\
**Example** Suppose you compute a \)</span>\chi^2<span class="math notranslate nohighlight">\( of 20 for N=5 points. The
feeling is that the function is a very poor model of the data
(\)</span>20/5 =4 \gg 1<span class="math notranslate nohighlight">\(). To quantify that we compute the \)</span>\chi^2<span class="math notranslate nohighlight">\( probability
\)</span>\int_{20}^{\infty}P(\chi^2,5)d\chi^2<span class="math notranslate nohighlight">\(. In `ROOT` you can compute this
as `TMath::Prob(20,5) = 0.0012`. The \)</span>\chi^2<span class="math notranslate nohighlight">\( probability is indeed very
small and the \)</span>H_0<span class="math notranslate nohighlight">\( hypothesis should be discarded.\
\
You have to be careful when using the \)</span>\chi^2<span class="math notranslate nohighlight">\( probability to take
decisions. For instance if the \)</span>\chi^2<span class="math notranslate nohighlight">\( is large, giving a very small
\)</span>\chi^2<span class="math notranslate nohighlight">\( probability, it could be both that the function \)</span>f<span class="math notranslate nohighlight">\( is a bad
representation of the data or that the uncertainties are underestimated.
On the other hand if you obtain a very small value for the \)</span>\chi^2<span class="math notranslate nohighlight">\(, the
function cannot be blamed[^4], so you might have overestimated the
uncertainties. It's up to you to interpret correctly the meaning of the
probability. A very useful tool for this scope is the **pull
distribution** (see
Sec. [\[sec:MLremarks\]](#sec:MLremarks){reference-type=&quot;ref&quot;
reference=&quot;sec:MLremarks&quot;}), where each entry is defined as
(measured-predicted)/uncertainty = \)</span>(y_i - f(x_i))/ \sigma_i$; if
everything is done correctly (i.e. the model is correct and the
uncertainties are computed correctly) the pull will result in a normal
distribution centred at 0 with width 1. If the pull is not centred at 0
(bias) the model is incorrect, if the pull has a width larger than 1
either the uncertainties are underestimated or the model is wrong, if
the pull has a width smaller than 1 the uncertainties are
overestimated.\</p>
</div>
<div class="section" id="degrees-of-freedom-for-chi-2-test-on-fitted-data">
<h3>Degrees of freedom for <span class="math notranslate nohighlight">\(\chi^2\)</span>-test on fitted data<a class="headerlink" href="#degrees-of-freedom-for-chi-2-test-on-fitted-data" title="Permalink to this headline">¶</a></h3>
<p>The concept of <span class="math notranslate nohighlight">\(\chi^2\)</span> developed above only works if you are given a
set of data points and a function (model). If the function comes out
<em>from a fit to the data</em> then, by construction, you will get a <span class="math notranslate nohighlight">\(\chi^2\)</span>
which is the smallest, because you fit the parameters of the function in
order to minimize it.<br />
This problem turns out to be very easy to treat. You just need to remove
degrees of freedom from the computation. For example, suppose you have
<span class="math notranslate nohighlight">\(N\)</span> points and you fitted <span class="math notranslate nohighlight">\(m\)</span> parameters of your function to minimize
the <span class="math notranslate nohighlight">\(\chi^2\)</span> sum; then all you have to do to compute the new <span class="math notranslate nohighlight">\(\chi^2\)</span>
probability is to reduce the number of d.o.f. to <span class="math notranslate nohighlight">\(n=N-m\)</span>.<br />
<br />
<strong>Example</strong>  You have a set of 20 points, you consider as function f(x)
a straight line and you get <span class="math notranslate nohighlight">\(\chi^2 = 36.3\)</span>. If you use a parabola you
get <span class="math notranslate nohighlight">\(\chi^2 = 20.1\)</span>. The straight line has 2 degrees of freedom (slope
and intercept), so the number of d.o.f. of the problem is 20-2=18; the
<span class="math notranslate nohighlight">\(\chi^2\)</span> probability is <code class="docutils literal notranslate"><span class="pre">TMath::Prob(36.3,18)</span> <span class="pre">=</span> <span class="pre">0.0065</span></code> which makes the
hypothesis that data are described by a straight line improbable. If you
now fit it with a parabola you get <code class="docutils literal notranslate"><span class="pre">TMath::Prob(20.1,17)</span> <span class="pre">=</span> <span class="pre">0.27</span></code> which
means that you can’t reject the hypothesis that the data are distributed
according to a parabolic shape.<br />
<br />
Notes on the <span class="math notranslate nohighlight">\(\chi^{2}\)</span>-test:</p>
<ul class="simple">
<li><p>For large values of d.o.f. the distribution of <span class="math notranslate nohighlight">\(\sqrt{2\chi^2}\)</span> can
be approximated with a Gaussian distribution with mean <span class="math notranslate nohighlight">\(\sqrt{2n-1}\)</span>
and standard deviation <span class="math notranslate nohighlight">\(1\)</span>. When in the past the integrals were
extracted from tables this was a neat trick; still it is a useful
simplification when the the <span class="math notranslate nohighlight">\(\chi^2\)</span> is used in some explicit
calculation.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(\chi^{2}\)</span>-test can also be used as a goodness of fit test for
binned data. The number of events in bin <span class="math notranslate nohighlight">\(i\)</span> (<span class="math notranslate nohighlight">\(i = 1, 2, \ldots, n\)</span>)
are <span class="math notranslate nohighlight">\(y_{i}\)</span>, with bin <span class="math notranslate nohighlight">\(i\)</span> having mean value <span class="math notranslate nohighlight">\(x_{i}\)</span>. The predicted
number of events is thus <span class="math notranslate nohighlight">\(f(x_{i})\)</span>. The errors are given by Poisson
statistics in the bin (<span class="math notranslate nohighlight">\(\sqrt{f(x_i)}\)</span>, see
<a class="reference external" href="#sec:binnedchi2">[sec:binnedchi2]</a>{reference-type=”ref”
reference=”sec:binnedchi2”} for the use of the Poisson
uncertainties) and the <span class="math notranslate nohighlight">\(\chi^{2}\)</span> is
$<span class="math notranslate nohighlight">\(\chi^{2} = \sum_{i=1}^{n}\frac{[y_{i}-f(x_{i})]^{2}}{f(x_{i})},\)</span><span class="math notranslate nohighlight">\(
where the number of degrees of freedom \)</span>n$ is given by the number of
bins minus the number of fitted parameters (do not forget the
overall normalization of the model when counting the number of
fitted parameters).</p></li>
<li><p>when binning data, you should try to have enough entries per bin
such that the computation of the <span class="math notranslate nohighlight">\(\chi^2\)</span> is actually meaningful; as
a rule of thumb you should have <em>at least 5 entries per bin</em>. Most
of the results for binned data are only true asymptotically.</p></li>
</ul>
</div>
<div class="section" id="run-test">
<h3>Run test<a class="headerlink" href="#run-test" title="Permalink to this headline">¶</a></h3>
<p>The <span class="math notranslate nohighlight">\(\chi^2\)</span> collapses in one number the level of agreement between a
hypothesis and a set of data. There are cases where behind a
<span class="math notranslate nohighlight">\(\chi^2\sim 1\)</span> hides in reality a very poor agreement between the data
and the model. Consider the situation which is illustrated in
Fig. <a class="reference external" href="#RunTestPicture">1.10</a>{reference-type=”ref”
reference=”RunTestPicture”}. The 12 data points are fitted by a straight
line, which clearly does not describe the data adequately. Nevertheless,
in this example, the <span class="math notranslate nohighlight">\(\chi^{2}\)</span> is 12.0 and thus <span class="math notranslate nohighlight">\(\chi^{2} / n = 1\)</span>.</p>
<p><img alt="[[RunTestPicture]]{#RunTestPicture label=&quot;RunTestPicture&quot;}Examplefor the application of the run test. The dashed line is the hypothesizedfit (a straight line), whereas the crosses are the actualdata." src="Section8Bilder/RunTestPicture.pdf" />{#RunTestPicture width=”35%”}</p>
<p>In cases such as this one the <strong>run test</strong> provides important extra
information. The run test works like this: every time the measured data
point lies <em>Above</em> the function, we write an <span class="math notranslate nohighlight">\(A\)</span> in a sequence, and
every time the data lies <em>Below</em> the function, we write a <span class="math notranslate nohighlight">\(B\)</span>. If the
data are distributed according to the hypothesis function, then they
should fluctuate up and down creating very short sequences of A’s and
B’s (<em>runs</em>). The sequence in the pictures reads <span class="math notranslate nohighlight">\(AAABBBBBBAAA\)</span>, making
only three runs and possibly pointing to a poor description of the
data.<br />
The probability of the A’s and B’s giving a particular number of runs
can be calculated. Suppose there are <span class="math notranslate nohighlight">\(N_A\)</span> points above and <span class="math notranslate nohighlight">\(N_B\)</span> below
with <span class="math notranslate nohighlight">\(N=N_A+N_B\)</span>. The total number of possible combinations without
repetitions is given by (see chapter 1):
$<span class="math notranslate nohighlight">\({N \choose N_A} = \frac{N!}{N_A!~N_B!}\)</span><span class="math notranslate nohighlight">\( this will be our denominator.
For the numerator suppose that \)</span>r<span class="math notranslate nohighlight">\( is even and the sequence starts with
an A. There are \)</span>N_A<span class="math notranslate nohighlight">\( A-points and \)</span>r/2-1<span class="math notranslate nohighlight">\( divisions between them
(occupied by B's). With \)</span>N_A<span class="math notranslate nohighlight">\( point you can place \)</span>N_A-1<span class="math notranslate nohighlight">\( dividing line,
in the next step \)</span>N_A-2<span class="math notranslate nohighlight">\( and so on, giving \)</span>{N_A-1 \choose r/2-1}<span class="math notranslate nohighlight">\(
different A arrangements. The same argument can be made for the B's. So
we find for the probability of \)</span>r<span class="math notranslate nohighlight">\( runs:
\)</span><span class="math notranslate nohighlight">\(P_{r} = 2 \frac{{N_{A}-1 \choose r/2-1} \cdot {N_{B}-1 \choose r/2 -1}}{{N \choose N_{A}}},\)</span><span class="math notranslate nohighlight">\(
where the extra factor of 2 is there because we chose to start with an A
and we could have started with a B. When \)</span>r<span class="math notranslate nohighlight">\( is odd you get:
\)</span><span class="math notranslate nohighlight">\(P_{r} = 2 \frac{{N_{A}-1 \choose (r-3)/2} \cdot {N_{B}-1 \choose (r-1)/2} + {N_{A}-1 \choose (r-1)/2} \cdot {N_{B}-1 \choose (r-3)/2}} {{N \choose N_{A}}}\)</span><span class="math notranslate nohighlight">\(
These are probabilities to get \)</span>r<span class="math notranslate nohighlight">\( runs given a sequence of A's and
B's.\
It can be shown that \)</span><span class="math notranslate nohighlight">\(\begin{aligned}
\langle r \rangle &amp;=&amp; 1 + \frac{2N_{A}N_{B}}{N}\\
V(r) &amp; = &amp; \frac{2N_{A}N_{B}(2N_{A}N_{B}-N)}{N^{2}(N-1)}\end{aligned}\)</span><span class="math notranslate nohighlight">\(
In the example above the number of expected runs is
\)</span>\langle r \rangle = 1 +2 \cdot 6 \cdot 6/12 = 7<span class="math notranslate nohighlight">\( with \)</span>\sigma = 1.65<span class="math notranslate nohighlight">\(.
The deviation between the expected and the observed is \)</span>7-3 = 4<span class="math notranslate nohighlight">\( and it
constitutes 2.4 standard deviations which is significant at the 1% level
for the one-sided test. Thus the straight line fit could be rejected
despite the (far too) good \)</span>\chi^{2}<span class="math notranslate nohighlight">\( value.\
The run test does not substitute the \)</span>\chi^2<span class="math notranslate nohighlight">\( test, it's in a sense
complementary; the \)</span>\chi^2$ test ignore the sign of the fluctuations,
while the run test only looks at them.</p>
</div>
</div>
<div class="section" id="unbinned-tests-sec-ks">
<h2>Unbinned tests {#sec:KS}<a class="headerlink" href="#unbinned-tests-sec-ks" title="Permalink to this headline">¶</a></h2>
<p>Unbinned tests are used when the binning procedure would result in a too
large loss of information (e.g. when the data set is small). They are
all based on the comparison of the cumulative distribution function
(c.d.f.) <span class="math notranslate nohighlight">\(F(x)\)</span> of the model <span class="math notranslate nohighlight">\(f(x)\)</span> under some hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> and the
c.d.f. for the data. To define a c.d.f. on data we define an order
statistics, i.e. a rule to order the data<a class="footnote-reference brackets" href="#id8" id="id4">5</a> and then define on it the
<em>Empirical Cumulative Distribution Function</em> e.c.d.f.: $<span class="math notranslate nohighlight">\(S_n(x) =
\left\{
\begin{array}{rll}
  0 &amp;\mbox{,} &amp; x &lt;x_1 \\
  \frac{r}{n} &amp;\mbox{,} &amp; x_r \le x  &lt; x_{r+1} \\
  1 &amp;\mbox{,} &amp; x_n &lt;x 
\end{array}
\right.\)</span><span class="math notranslate nohighlight">\( This is just the fraction of events not exceeding x (which is
a staircase function from 0 to 1), see
Fig. [\[fig:KS\]](#fig:KS){reference-type=&quot;ref&quot; reference=&quot;fig:KS&quot;}.\
\
The first unbinned test we describe is the **Smirnov-Cramér-von Mises**
test. We define a measure of the distance between \)</span>S_n(x)<span class="math notranslate nohighlight">\( and F(x) as:
\)</span><span class="math notranslate nohighlight">\(W^2 = \int_0^1 [S_n(x) - F(x)]^2 dF(x)\)</span><span class="math notranslate nohighlight">\( (dF(x) can be in general a
non decreasing weight). Inserting the explicit expression of \)</span>S_n(x)<span class="math notranslate nohighlight">\( in
this definition we get:
\)</span><span class="math notranslate nohighlight">\(nW^2 = \frac{1}{12n} + \sum_{i=1}^n \left( F(x_i) - \frac{2i-1}{2n}   \right)^2\)</span><span class="math notranslate nohighlight">\(
From the asymptotic distribution of \)</span>nW^2<span class="math notranslate nohighlight">\( the critical regions can be
computed: frequently used test sizes are given in the
Tab. [1.11](#fig:skvm){reference-type=&quot;ref&quot; reference=&quot;fig:skvm&quot;}. The
asymptotic distribution is reached remarkably rapidly (in this table the
asymptotic limit is reached for \)</span>n \ge 3$).\</p>
<p><img alt="[[fig:skvm]]{#fig:skvm label=&quot;fig:skvm&quot;}Rejection regions for theSmirnov-Cramér-von Mises test the for some typical testsizes." src="Section8Bilder/smirnovCramer.png" />{#fig:skvm width=”30%”}</p>
<p><br />
The <strong>Kolmogorov-Smirnov</strong> test follows the same idea of comparing the
model c.d.f. with the data e.c.d.f. but it defines a different metric
for the distance between the two. The test statistic is
<span class="math notranslate nohighlight">\(d := D \sqrt{N}\)</span> where <span class="math notranslate nohighlight">\(D\)</span> is the maximal vertical difference between
<span class="math notranslate nohighlight">\(F_{n}(x)\)</span> and <span class="math notranslate nohighlight">\(F(x)\)</span> (see
Fig. <a class="reference external" href="#fig:KS">[fig:KS]</a>{reference-type=”ref” reference=”fig:KS”}):
$<span class="math notranslate nohighlight">\(D := \max_{x} |S_{n}(x)-F(x)|\)</span><span class="math notranslate nohighlight">\( The hypothesis \)</span>H_{0}<span class="math notranslate nohighlight">\( corresponding
to the function \)</span>f(x)<span class="math notranslate nohighlight">\( is rejected if \)</span>d<span class="math notranslate nohighlight">\( is larger than a given
critical value. The probability \)</span>P(d\le t_0)$ can be calculated in
<code class="docutils literal notranslate"><span class="pre">ROOT</span></code> by <code class="docutils literal notranslate"><span class="pre">TMath::KolmogorovProb(t0)</span></code>. Some values are reported in
Tab. <a class="reference external" href="#KSTable">1.1</a>{reference-type=”ref” reference=”KSTable”}.<br />
\</p>
<p><img alt="[[fig:KS]]{#fig:KS label=&quot;fig:KS&quot;}Example of c.d.f. and e.c.d.f..The arrow indicates the largest distance used by the Kolmogorov-Smirnovtest." src="Section8Bilder/KS_Example.png" />{#Kolmogorov1 width=”50%”}</p>
<p><br />
The Kolmogorov-Smirnov test can also be used to test if <em>two data sets</em>
have been drawn from the same parent distribution. Take the two
histograms corresponding to the data to be compared and normalize them
(such that the cumulative plateaus at 1). Then compare the e.c.d.f. for
the two histograms and compute the maximum distance as before (in <code class="docutils literal notranslate"><span class="pre">ROOT</span></code>
use <code class="docutils literal notranslate"><span class="pre">h1.KolmogorovTest(h2)</span></code>).<br />
<br />
Notes on the Kolmogorov-Smirnov test:</p>
<ul class="simple">
<li><p>the test is more sensitive to departures of the data from the median
of <span class="math notranslate nohighlight">\(H_0\)</span> than to departures from the width (more sensitive to the
core than to the tails of the distributions)</p></li>
<li><p>the test becomes meaningless if the <span class="math notranslate nohighlight">\(H_0\)</span> p.d.f. is a fit to the
data. This is due to the fact that there is no equivalent of the
number of degrees of freedom as in the <span class="math notranslate nohighlight">\(\chi^{2}\)</span>-test, hence it
cannot be corrected for.</p></li>
</ul>
</div>
<div class="section" id="two-sample-problem-sectiondistributiondependingtests">
<h2>Two-sample problem {#SectionDistributionDependingTests}<a class="headerlink" href="#two-sample-problem-sectiondistributiondependingtests" title="Permalink to this headline">¶</a></h2>
<p>In this section we will look at the problem of telling if two samples
are compatible with each other, i.e. if both are drawn from the same
parent distribution. Clearly the complication is that, even if they are,
they will exhibit differences coming from statistical fluctuations. In
the following we will examine some typical examples of two-sample
problems (see Tab. <a class="reference external" href="#hypo2">1.2</a>{reference-type=”ref”
reference=”hypo2”}).</p>
<div class="section" id="two-gaussians-known-sigma-sec-knownsigma">
<h3>Two Gaussians, known <span class="math notranslate nohighlight">\(\sigma\)</span> {#sec:knownsigma}<a class="headerlink" href="#two-gaussians-known-sigma-sec-knownsigma" title="Permalink to this headline">¶</a></h3>
<p>Suppose you have two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> distributed as
Gaussians of known width. Typical situations are when you have two
measurements taken with the same device with a known resolution; or two
samples are taken under different conditions where the variances of the
parent distribution are known (you have the two means
<span class="math notranslate nohighlight">\(\langle X \rangle\)</span>, <span class="math notranslate nohighlight">\(\langle Y \rangle\)</span> and the uncertainty on the
means <span class="math notranslate nohighlight">\(\sigma_x/\sqrt{N_x}\)</span> and <span class="math notranslate nohighlight">\(\sigma_y/\sqrt{N_y}\)</span>).<br />
This problem is equivalent to check if <span class="math notranslate nohighlight">\(X-Y\)</span> is compatible with <span class="math notranslate nohighlight">\(0\)</span>. The
variance of <span class="math notranslate nohighlight">\(X-Y\)</span> is <span class="math notranslate nohighlight">\(V(X-Y) = \sigma_x^2 +\sigma_y^2\)</span> and so the
problem boils down to how many <span class="math notranslate nohighlight">\(\sigma\)</span> the difference is from 0:
<span class="math notranslate nohighlight">\((X-Y)/ \sqrt{\sigma_x^2 + \sigma_y^2}\)</span>.<br />
More generally what you are doing is defining a test statistics
<span class="math notranslate nohighlight">\(\frac{|\langle x \rangle - \mu_0|}{\sigma/\sqrt{N}}\)</span> (in the previous
case <span class="math notranslate nohighlight">\(\mu_0 = 0\)</span>) and a double sided rejection region. This means that
you choose the significance of your test (<span class="math notranslate nohighlight">\(\alpha\)</span>) and set as rejection
region the (symmetric) values <span class="math notranslate nohighlight">\(u_{1-\alpha/2}\)</span> on the corresponding
Gaussian as:
$<span class="math notranslate nohighlight">\(\int_{-\infty}^{u_{1-\alpha/2}} G(x;\mu_0,\sigma)dx  = \int_{u_{1-\alpha/2}}^{\infty} G(x;\mu_0,\sigma)dx = \frac{\alpha}{2}\)</span><span class="math notranslate nohighlight">\(
If the measured difference ends up in the rejection region (either of
the two tails) then the two samples are to be considered different.\
You can also test whether \)</span>X&gt;Y<span class="math notranslate nohighlight">\( (or \)</span>Y&gt;X<span class="math notranslate nohighlight">\(). In this case the test
statistic is \)</span>\frac{(\langle x \rangle - \mu_0)}{\sigma/\sqrt{N}}<span class="math notranslate nohighlight">\( and
the rejection region becomes single sided \)</span>(u_{1-\alpha},\infty)<span class="math notranslate nohighlight">\( (or
\)</span>(-\infty,u_{1-\alpha})$).</p>
</div>
<div class="section" id="two-gaussians-unknown-sigma-student-t">
<h3>Two Gaussians, unknown <span class="math notranslate nohighlight">\(\sigma\)</span> {#student-t}<a class="headerlink" href="#two-gaussians-unknown-sigma-student-t" title="Permalink to this headline">¶</a></h3>
<p>The problem is similar to the previous one, you’re comparing two
Gaussian distributions with means <span class="math notranslate nohighlight">\(\langle X \rangle\)</span> and
<span class="math notranslate nohighlight">\(\langle Y \rangle\)</span>, but this time you don’t know what are the parents’
standard deviations. All you can do is to estimate them from the samples
at hand:
$<span class="math notranslate nohighlight">\(s^2_x = \frac{\sum(x_i -\langle x\rangle)^2}{N_x-1} \qquad ; \qquad s^2_y = \frac{\sum(y_i -\langle y\rangle)^2}{N_y-1}.\)</span><span class="math notranslate nohighlight">\(
Because we're using the estimated standard deviation we have to build a
Student's \)</span>t<span class="math notranslate nohighlight">\( variable to test the significance, and not the Gaussian
p.d.f. as we did in the previous case. As we have seen in
Sec. [\[SectionStudentT\]](#SectionStudentT){reference-type=&quot;ref&quot;
reference=&quot;SectionStudentT&quot;} the \)</span>t<span class="math notranslate nohighlight">\(-variable comes from the ratio of a
Gaussian and a \)</span>\chi^2<span class="math notranslate nohighlight">\( variable; the trick was to cancel out in the
ratio our ignorance about \)</span>\sigma<span class="math notranslate nohighlight">\(.\
For the numerator, the expression
\)</span><span class="math notranslate nohighlight">\(\frac{\langle x \rangle - \langle y \rangle}{\sqrt{(\sigma_x^2/N_x)+(\sigma_y^2/N_y)}}\)</span><span class="math notranslate nohighlight">\(
under the null hypothesis that the two distributions have the same mean
(\)</span>\mu_x = \mu_y<span class="math notranslate nohighlight">\() is a Gaussian centred at zero with standard deviation
one.\
For the denominator, the sum
\)</span><span class="math notranslate nohighlight">\(\frac{(N_x-1)s_x^2}{\sigma_x^2} + \frac{(N_y-1)s_y^2}{\sigma_y^2}\)</span><span class="math notranslate nohighlight">\( is
a \)</span>\chi^2<span class="math notranslate nohighlight">\( (to convince yourself just plugin the \)</span>s^2_x<span class="math notranslate nohighlight">\( and \)</span>s^2_y<span class="math notranslate nohighlight">\(
written above) with \)</span>N_x+N_y-2<span class="math notranslate nohighlight">\( d.o.f, because we used them to compute
the means.\
If we assume that the unknown parent standard deviation is the same for
the two samples \)</span>\sigma_x = \sigma_y<span class="math notranslate nohighlight">\(, that will do the trick: \)</span>\sigma<span class="math notranslate nohighlight">\(
cancels out in the ratio. The definition for the \)</span>t<span class="math notranslate nohighlight">\(-distribution
becomes:
\)</span><span class="math notranslate nohighlight">\(t = \frac{\langle x \rangle - \langle y \rangle}{S \sqrt{(1/N_x)+(1/N_y)}}\)</span><span class="math notranslate nohighlight">\(
where \)</span><span class="math notranslate nohighlight">\(S^2 = \frac{(N_x-1)s_x^2 + (N_y-1)s_y^2}{N_x +N_x -2}\)</span><span class="math notranslate nohighlight">\( The
variable \)</span>t<span class="math notranslate nohighlight">\( is distributed as a Student's \)</span>t<span class="math notranslate nohighlight">\( with \)</span>N_x +N_x -2$ d.o.f.
With this variable we can now use the same testing procedure (double or
single sided rejection regions) used in the case shown
above <a class="reference external" href="#sec:knownsigma">1.7.1</a>{reference-type=”ref”
reference=”sec:knownsigma”}, substituting the c.d.f of the Gaussian with
the c.d.f. of the student’s t.\</p>
</div>
<div class="section" id="f-test-sec-ftest">
<h3>F-test {#sec:Ftest}<a class="headerlink" href="#f-test-sec-ftest" title="Permalink to this headline">¶</a></h3>
<p>The <span class="math notranslate nohighlight">\(F\)</span>-test is used to test whether the variances of two samples with
size <span class="math notranslate nohighlight">\(n_{1}\)</span> and <span class="math notranslate nohighlight">\(n_{2}\)</span>, respectively, are compatible. Because the true
variances are not known, the sample variances <span class="math notranslate nohighlight">\(V_{1}\)</span> and <span class="math notranslate nohighlight">\(V_{2}\)</span> are
used to build the ratio <span class="math notranslate nohighlight">\(F = \frac{V_{1}}{V_{2}}\)</span>. Recalling the
definition of the sample variance, we can write:
$<span class="math notranslate nohighlight">\(F= \frac{V_{1}}{V_{2}}=\frac{\frac{1}{n_{1}-1}\sum_{i=1}^{n_{1}}(x_{1_{i}}-\bar{x}_{1})^{2}}{\frac{1}{n_{2}-1}\sum_{i=1}^{n_{2}}(x_{2_{i}}-\bar{x}_{2})^{2}}\)</span><span class="math notranslate nohighlight">\(
(by convention the bigger sample variance is at the numerator, such that
\)</span>F \geq 1<span class="math notranslate nohighlight">\(). Intuitively the ratio will be close to 1 if the two
variances are similar, while it will go to a large value if they are
not. When you divide the variance by \)</span>\sigma^2<span class="math notranslate nohighlight">\( you obtain a random
variable which is distributed as a \)</span>\chi^2<span class="math notranslate nohighlight">\( with \)</span>N-1<span class="math notranslate nohighlight">\( d.o.f. Given that
the random variable \)</span>F<span class="math notranslate nohighlight">\( is the ratio of two such variables, the
\)</span>\sigma^2<span class="math notranslate nohighlight">\( cancels and we are left with the ratio of two \)</span>\chi^2<span class="math notranslate nohighlight">\(
distributions with \)</span>f_1 = N_1-1<span class="math notranslate nohighlight">\( d.o.f. for the numerator and
\)</span>f_2=N_2-1<span class="math notranslate nohighlight">\( d.o.f. for the denominator.\
The variable \)</span>F<span class="math notranslate nohighlight">\( follows the \)</span>F<span class="math notranslate nohighlight">\(-distribution with \)</span>f_1<span class="math notranslate nohighlight">\( and \)</span>f_2<span class="math notranslate nohighlight">\(
degrees of freedom: \)</span>F(f_{1},f_{2})<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(P(F) = \frac{\Gamma((f_1+f_2)/2)}{\Gamma(f_1/2)\Gamma(f_2/2)}\sqrt{f_1^{f_1} f_2^{f_2}}\frac{F^{f_1/2-1}}{(f_1+f_2F)^{(f_1+f_2)/2}}\)</span><span class="math notranslate nohighlight">\(
For large numbers, the variable \)</span><span class="math notranslate nohighlight">\(Z  = \frac{1}{2} \log{F}\)</span><span class="math notranslate nohighlight">\( converges
to a Gaussian distribution with mean \)</span>\frac{1}{2}(1/f_2-1/f_1)<span class="math notranslate nohighlight">\( and
variance \)</span>\frac{1}{2}(1/f_2+1/f_1)<span class="math notranslate nohighlight">\(. In any case you can test the
compatibility by using e.g. the `ROOT` function
`TMath::fdistribution_pdf`.\
\
**Example** Background model for the \)</span>H\to \gamma\gamma$ search: The
collected diphoton events are divided in several categories (based on
resolution and S/B to optimize the analysis sensitivity). Once a model
for the background is chosen (e.g. a polynomial) the number of d.o.f.
for that model (e.g. the order of the polynomial) can be chosen using an
F-test. The main idea is gradually increase the number of d.o.f. until
you don’t see any decrease in the variance (see snapshot of the text
here below).</p>
<p><img alt="image" src="Section8Bilder/FtestHgg.png" />{#fig:FtestHgg width=”100%”}</p>
<p>[[fig:FtestHgg]]{#fig:FtestHgg label=”fig:FtestHgg”}</p>
<p><br />
\</p>
</div>
<div class="section" id="matched-and-correlated-samples">
<h3>Matched and correlated samples<a class="headerlink" href="#matched-and-correlated-samples" title="Permalink to this headline">¶</a></h3>
<p>In the previous sections we’ve seen how to compare two samples under
different hypothesis. The tests are more discriminating the smaller are
their variances. Correlations between the two samples can be used to our
advantage to reduce the variance. Take as test statistic:
$<span class="math notranslate nohighlight">\(\sum_i (x_i-y_i)\)</span><span class="math notranslate nohighlight">\( where each of the data point of the first sample is
paired to a corresponding one in the second sample. The variance of this
distribution is:
\)</span><span class="math notranslate nohighlight">\(V(x-y) = \sigma_x^2 + \sigma_y^2 - 2\rho \sigma_x \sigma_y\)</span><span class="math notranslate nohighlight">\( Now, if
the two samples are correlated (\)</span>\rho &gt; 0$) then the variance is reduced
and will make the test more discriminating.<br />
<br />
<strong>Example</strong>  A consumer magazine is testing a widget claimed to increase
fuel economy. Here are the data on seven cars are reported in
Tab. <a class="reference external" href="#fig:cars">1.14</a>{reference-type=”ref” reference=”fig:cars”}. Is
there evidence for any improvement?</p>
<p><img alt="[[fig:cars]]{#fig:cars label=&quot;fig:cars&quot;}Data from sevencars." src="Section8Bilder/cars.png" />{#fig:cars width=”100%”}</p>
<p>If you ignore the matching, the means are <span class="math notranslate nohighlight">\(38.6 \pm 3.0\)</span> and
<span class="math notranslate nohighlight">\(35.6 \pm 2.3\)</span> for the samples with and without the widget. The
improvement of 3 m.p.g. is within the statistical uncertainties. Now
look at the differences. Their average is 3.0. The estimated standard
deviation s is 3.6, so the error on the estimated average is
<span class="math notranslate nohighlight">\(3.6/ \sqrt{7} = 1.3\)</span>, and t is <span class="math notranslate nohighlight">\(3.6/1.3 = 2.0\)</span>. This is significant at
the 5% level using Student’s t (one-tailed test, 6 degrees of freedom,
<span class="math notranslate nohighlight">\(t_{critic}= 1.943\)</span>).</p>
</div>
<div class="section" id="the-most-general-test">
<h3>The most general test<a class="headerlink" href="#the-most-general-test" title="Permalink to this headline">¶</a></h3>
<p>As we already said the more precisely the test can be formulated, the
more discriminant it will be. The most general two-sample test, makes no
assumptions at all on the two distributions, it just asks whether the
two are the same.<br />
You can apply an unbinned test like the the Kolmogorov-Smirnov (as
explained in Sec. <a class="reference external" href="#sec:KS">1.6</a>{reference-type=”ref”
reference=”sec:KS”}) by ordering the two samples and computing the
maximal distance between the two e.c.d.f. Or you can approach the
problem ordering together both samples and then apply a run-test. If the
two samples are drawn from the same parent distribution there will be
several very short runs; if on the other hand the two samples are from
different parent distributions you will have long runs from both
samples. This test can be tried only if he number of points in sample A
is similar to the one in sample B.<br />
<br />
<strong>Example</strong>  Two samples A and B from the same parent distribution will
give something like: <span class="math notranslate nohighlight">\(AABBABABAABBAABABAABBBA\)</span>.<br />
Two samples from two narrow distributions with different means will give
something like:<br />
<span class="math notranslate nohighlight">\(AAAAAAAAAABBBBBBBBBBBBB\)</span>.<br />
\</p>
</div>
</div>
<div class="section" id="anova">
<h2>ANOVA<a class="headerlink" href="#anova" title="Permalink to this headline">¶</a></h2>
<p>The analysis of variance (ANOVA) is a technique rarely used in high
energy physics, but because of its use in natural sciences a brief
introduction will be given.<br />
The idea is a generalization of the two sample problem: instead of two
samples you are confronted with several. The obvious approach to compare
the different samples in pairs doesn’t work. Suppose as an example that
you have 15 samples and you have to decide if they are sampled from the
same parent distribution (i.e. they are “compatible”). If you start
comparing them in pairs you will end up with <span class="math notranslate nohighlight">\(\binom{15}{2}\)</span> = 105
pairs. If you now set the significance at the 99% the probability to
have all of them passing is <span class="math notranslate nohighlight">\((1-0.01)^{105}\)</span> = 0.348, i.e. the
probability to make a type 1 error (reject the true hypothesis that they
all come from the same parent distribution) is 1-0.348 = 0.652.<br />
To expose the ANOVA method we take the simple case where all samples
(“groups” as they are generally called in ANOVA) are Gaussian of the
same unknown variance and we want to check if their means are compatible
with the hypothesis of being all samples taken from the same parent
distribution.<br />
To fix the notation we set <span class="math notranslate nohighlight">\((\mu,\sigma)\)</span> the true mean and width of the
parent distribution; <span class="math notranslate nohighlight">\(n\)</span> the number of groups <span class="math notranslate nohighlight">\(g\)</span> each with a number of
events <span class="math notranslate nohighlight">\(N_g\)</span> and mean and variance <span class="math notranslate nohighlight">\((\bar{x}_g,V_g)\)</span> and true (unknown)
sample mean <span class="math notranslate nohighlight">\(\mu_g\)</span>. The total number of events is <span class="math notranslate nohighlight">\(N\)</span> and the mean and
variance of the sample made summing together all groups are
<span class="math notranslate nohighlight">\((\bar{x},V)\)</span>.<br />
The null hypothesis we want to test is <span class="math notranslate nohighlight">\(H_0\)</span> all groups are compatible
(all <span class="math notranslate nohighlight">\(\mu_g\)</span> are the same and equal to <span class="math notranslate nohighlight">\(\mu\)</span>), the alternative
hypothesis <span class="math notranslate nohighlight">\(H_1\)</span> is that there are differences.<br />
To test if the groups are compatible means that we will have to say
whether the variations we see from one group to the other are just
statistical fluctuations or they are indeed the expression of coming
from different parent distributions. Let’s define the “spread <em>between</em>
the groups” as the spread of their means <span class="math notranslate nohighlight">\(\bar{x_g}\)</span> which follows the
<span class="math notranslate nohighlight">\(\sigma\)</span> of the parent distribution. Clearly we don’t know <span class="math notranslate nohighlight">\(\sigma\)</span> but
it can be estimated from the data itself looking at the variation
“<em>within</em> the groups”. Stated in this way the problem can be solved
using the <span class="math notranslate nohighlight">\(F-\)</span>test we ecountered in the previous section, by comparing
the variances “between” and “within” the groups:
$<span class="math notranslate nohighlight">\(F=\frac{V_b}{V_w} = \frac{between}{within}\)</span><span class="math notranslate nohighlight">\( The numerator, the
variance between the groups, can be taken as:
\)</span><span class="math notranslate nohighlight">\(\frac{1}{n-1} \sum_g N_g (\bar{x}_g - \bar{x})^2.\)</span><span class="math notranslate nohighlight">\( There are \)</span>n-1<span class="math notranslate nohighlight">\(
degrees of freedom because the mean is taken as \)</span>\bar{x}_g<span class="math notranslate nohighlight">\(. As for the
denominator we can take the estimate of \)</span>\sigma<span class="math notranslate nohighlight">\( from the different
groups: \)</span><span class="math notranslate nohighlight">\(\frac{1}{N-n}\sum_g \sum_{i\in g} (x_i - \bar{x}_g)^2\)</span><span class="math notranslate nohighlight">\( where
\)</span>g<span class="math notranslate nohighlight">\( is the group and \)</span>i<span class="math notranslate nohighlight">\( is the element within that group.\
By taking the ratio of numerator and denominator we obtain an \)</span>F-<span class="math notranslate nohighlight">\(test.
Now we just need to set the critical value for the desidered
significance level and proceed as in the \)</span>F-<span class="math notranslate nohighlight">\( test. Note that the ANOVA
method formally reduces to the Student's \)</span>t$ discussed
in <a class="reference external" href="#student-t">1.7.2</a>{reference-type=”ref” reference=”student-t”} when
you have only two samples.<br />
<br />
<strong>Example</strong>  As an example we take the shares of industrial, financial,
and textile sectors for a particular day see
Tab. <a class="reference external" href="#tab:anovaEx">1.3</a>{reference-type=”ref” reference=”tab:anovaEx”}.
Is there any difference in the behaviour of the different sectors ?\</p>
<p>We can compute:</p>
<ul class="simple">
<li><p>total average: <span class="math notranslate nohighlight">\(\bar{x}\)</span> = 0.48</p></li>
<li><p>average for group 1: <span class="math notranslate nohighlight">\(\bar{x}_1\)</span> = 0.25; <span class="math notranslate nohighlight">\(\bar{x}_1 - \bar{x}\)</span> =0.23</p></li>
<li><p>average for group 2: <span class="math notranslate nohighlight">\(\bar{x}_2\)</span> = 0.18; <span class="math notranslate nohighlight">\(\bar{x}_2 - \bar{x}\)</span> =0.30</p></li>
<li><p>average for group 3: <span class="math notranslate nohighlight">\(\bar{x}_3\)</span> = 1.5; <span class="math notranslate nohighlight">\(\bar{x}_3 - \bar{x}\)</span> =1.02</p></li>
</ul>
<p>Computing the numerator we get
<span class="math notranslate nohighlight">\(1/2 (12\times 0.23^2 + 11 \times 0.30^2 + 6\times 1.02^2) = 3.93\)</span>.
Computing the variances within the groups, for the denominator we have
<span class="math notranslate nohighlight">\((44.3 + 103.6 + 161.5) / 26 = 11.9\)</span>.<br />
The numerator (between) is even smaller than the denominator (within),
so we can say that there is no evidence for different behaviour in the
different sectors. If the numerator was larger than the denominator we
should have used the critical values for the <span class="math notranslate nohighlight">\(F-\)</span>test.</p>
</div>
<div class="section" id="resampling-techniques-sec-resampling">
<h2>Resampling techniques {#sec:resampling}<a class="headerlink" href="#resampling-techniques-sec-resampling" title="Permalink to this headline">¶</a></h2>
<p>Rasampling is a technique used for non-parametric estimation of the
statistical uncertainty (bias and variance) of a statistical estimator.
To get an idea of non-parametric statistics see e.g. wiki. In this
section we will review the two most used: jackknife and bootstrap
[&#64;ResamplingArticle].<br />
<br />
Non parametric techniques allow to <em>generalize the concept of
uncertainty to any estimator</em>. Take as an example a random sample of
size <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(\{ x_i\}\)</span> with <span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span>, taken from an unknown parent
distribution <span class="math notranslate nohighlight">\(F\)</span>. Typically you will characterize the sample by
computing the estimated mean and its standard deviation:
$<span class="math notranslate nohighlight">\(\bar{x} = \frac{\sum_i x_i}{n} \qquad; \qquad \hat{\sigma}=\left( \frac{1}{n-1} \sum_i (x_i - \bar{x})^2  \right)^{1/2}\)</span>$
The issue with this expression for the estimated standard deviation is
that it does not generalize to any other estimator but the mean. For
instance there is no way to extend it to compute the the standard
deviation of the median. The resampling techniques allow to make this
generalization.\</p>
<div class="section" id="jackknife">
<h3>Jackknife<a class="headerlink" href="#jackknife" title="Permalink to this headline">¶</a></h3>
<p>Let’s first introduce some notation. Let
$<span class="math notranslate nohighlight">\(\bar{x}_{(i)} = \frac{n\bar{x} -x_i}{n-1} = \frac{1}{n-1}\sum_{j \neq i} x_j\)</span><span class="math notranslate nohighlight">\(
be the average of the dataset constructed by the initial dataset, but
removing the i-th element (the new sample will have n-1 elements), also
known as the &quot;deleted average&quot;. Let
\)</span><span class="math notranslate nohighlight">\(\bar{x}_{(\cdot)} = \sum_i \frac{\bar{x}_{(i)}}{n}\)</span><span class="math notranslate nohighlight">\( be the average of
the sample at hand, i.e. the average of the averages computed on the
samples where we have removed the i-th element (the average of the
deleted averages).\
The **jackkinfe estimate of the standard error** is defined as:
\)</span><span class="math notranslate nohighlight">\(\bar{\sigma}_J = \left[\frac{n-1}{n} \sum_{i=1}^n (\bar{x}_{(i)} - \bar{x}_{(\cdot)})^2   \right]^{1/2}\)</span><span class="math notranslate nohighlight">\(
which is a different way of rewriting the standard deviation, i.e.
\)</span><span class="math notranslate nohighlight">\(\hat{\sigma} = \bar{\sigma}_J.\)</span><span class="math notranslate nohighlight">\( The advantage of this expression is
that it can trivially be generalized to any estimator \)</span>\hat{\theta}<span class="math notranslate nohighlight">\(
function of the \)</span>{x_i}<span class="math notranslate nohighlight">\( dataset:
\)</span>\hat{\theta} = \theta(x_1,\ldots,x_n)<span class="math notranslate nohighlight">\(. Just replace \)</span><span class="math notranslate nohighlight">\(\begin{aligned}
        \bar{x}_{(i)}     &amp;\to&amp; \hat{\theta}_{(i)} = \hat{\theta}(x_1,\ldots,x_{i-1},x_{i+1},\ldots,x_n)\\
        \bar{x}_{(\cdot)} &amp;\to&amp; \hat{\theta}_{(\cdot)} = \frac{\sum_i \hat{\theta}_{(i)}}{n}\end{aligned}\)</span>$
The jackknife in general perform less well than the bootstrap method
that we will see in the next section, but it is often preferred because
computationally less expensive.</p>
</div>
<div class="section" id="bootstrap">
<h3>Bootstrap<a class="headerlink" href="#bootstrap" title="Permalink to this headline">¶</a></h3>
<p>The bootstrap represents a generalization of the jackknife. Again let’s
start with some notation. Let <span class="math notranslate nohighlight">\(\hat{F}\)</span> be the empirical cumulative
probability distribution function (ECDF) of the data: $<span class="math notranslate nohighlight">\(\hat{F} (x) = 
\left\{
\begin{array}{rcl}
 0           &amp; , &amp; x&lt;x_{1}\\
 \frac{r}{n} &amp; , &amp; x_{r} \leq x &lt; x_{r+1}\\
 1           &amp; , &amp; x_{n} \leq x\\
\end{array}
\right.\)</span><span class="math notranslate nohighlight">\( and let's define \)</span>{x_i^<em>} = {x_1^</em>, \ldots x_n^<em>}<span class="math notranslate nohighlight">\( a
random sample taken from \)</span>\hat{F}<span class="math notranslate nohighlight">\(, i.e. the \)</span>x_i^</em><span class="math notranslate nohighlight">\( are drawn
independently with repetition from \)</span>{x_i} = {x_1, \ldots x_n}<span class="math notranslate nohighlight">\(.\
For each of these samples we can compute the average and the variance:
\)</span><span class="math notranslate nohighlight">\(\bar{x}^* = \frac{\sum_i x^*}{n} \qquad ; \qquad var_\cdot \bar{x}^* = \frac{1}{n^2} \sum_i (x_i - \bar{x})^2\)</span><span class="math notranslate nohighlight">\(
where the dot represents the sample at hand.\
As before with the jackknife this definition can be generalized to any
estimator \)</span>\bar{x}<em>{(\cdot)} \to \hat{\theta}</em>{(i)}<span class="math notranslate nohighlight">\( as
\)</span><span class="math notranslate nohighlight">\(\hat{\sigma}_B = \left[ var_\cdot \bar{\theta}(x_1^*,\ldots,x_n^*)\right]^{1/2}\)</span><span class="math notranslate nohighlight">\(
and it can be verified that
\)</span><span class="math notranslate nohighlight">\(\sqrt{\frac{n}{n-1}}~\sigma_B = \hat{\sigma}.\)</span><span class="math notranslate nohighlight">\( To clarify the
procedure let's take the correlation coefficient \)</span>\rho<span class="math notranslate nohighlight">\( as an example
for which we have the expression for its variance:
\)</span>\hat{\sigma} = \frac{1-\hat{\rho}^2}{\sqrt{n-3}}<span class="math notranslate nohighlight">\(. In
Fig. [1.15](#fig:dataBootstrap){reference-type=&quot;ref&quot;
reference=&quot;fig:dataBootstrap&quot;} is reported a dataset made of 15 points,
each representing the average LSAT and GPA [^6] scores for students
coming from school \)</span>i<span class="math notranslate nohighlight">\( entering the american law school in 1973. This
plot shows the correlation between the results of the admission exam
LSAT and the average grades of undergraduate students from a school.
From these data, we can estimate the sample correlation
\)</span>\hat{\rho}=0.776<span class="math notranslate nohighlight">\( and its uncertainty \)</span>\hat{\sigma} = 0.115$.</p>
<p><img alt="[[fig:dataBootstrap]]{#fig:dataBootstraplabel=&quot;fig:dataBootstrap&quot;}Data taken from[&#64;ResamplingArticle]" src="Section8Bilder/dataBootstrap.png" />{#fig:dataBootstrap
width=”50%”}</p>
<p>Now let’s compute the sample correlation and its uncertainty using the
bootstrap method writing esplicitly the algorithm.</p>
<ul class="simple">
<li><p>Build the ECDF <span class="math notranslate nohighlight">\(\hat{F}\)</span> on the bivariate distribution from the
dataset given above.</p></li>
<li><p>Draw a “bootstrap sample” <span class="math notranslate nohighlight">\((x_1^*,\ldots,x_n^*)\)</span>, i.e. take <span class="math notranslate nohighlight">\(n\)</span>
random draws with repetition from <span class="math notranslate nohighlight">\((x_1,\ldots,x_n)\)</span></p></li>
<li><p>Compute the value of the statistics (in this case the correlation
coefficient) from the bootstrapped sample
<span class="math notranslate nohighlight">\(\hat{\rho}^* = \hat{\rho}(x_1^*,\ldots,x_n^*)\)</span></p></li>
<li><p>Repeat steps 2) and 3) a large number of times <span class="math notranslate nohighlight">\(B\)</span> obtaining <span class="math notranslate nohighlight">\(B\)</span>
estimations of the correlation coefficient:
<span class="math notranslate nohighlight">\(\hat{\rho}^{*1}, \hat{\rho}^{*2},\ldots,\hat{\rho}^{*B}\)</span></p></li>
<li><p>Finally compute
<span class="math notranslate nohighlight">\(\hat{\sigma}_B = \left( \sum_{b=1}^B(\hat{\rho}^{*b} - \hat{\rho}^{*\cdot} )^2/(B-1)  \right)^{1/2}\)</span>;
where <span class="math notranslate nohighlight">\(\hat{\rho}^{*\cdot} = \frac{\sum \hat{\rho}^{*b}}{B}\)</span></p></li>
</ul>
<p>Fig. <a class="reference external" href="#fig:bootstrap">1.16</a>{reference-type=”ref”
reference=”fig:bootstrap”} shows the ditribution of
<span class="math notranslate nohighlight">\(\hat{\rho}^* - \hat{\rho}\)</span>, i.e. <span class="math notranslate nohighlight">\(\hat{\rho}^* -0.776\)</span> the residual
between the bootstrapped estimations and the <span class="math notranslate nohighlight">\(\rho\)</span> computed on the
dataset, using the esplicit formula. The plot has been obtained using
<span class="math notranslate nohighlight">\(B = 1000\)</span>, i.e. computing
<span class="math notranslate nohighlight">\(\hat{\rho}^{*1}, \hat{\rho}^{*2},\ldots,\hat{\rho}^{*1000}\)</span>. Using the
algorithm above we obtained <span class="math notranslate nohighlight">\(\hat{\sigma}_B = 0.127\)</span> to be compared with
the <span class="math notranslate nohighlight">\(\hat{\sigma} = 0.115\)</span>.<br />
\</p>
<p><img alt="[[fig:bootstrap]]{#fig:bootstrap label=&quot;fig:bootstrap&quot;} Histogram of bootstrap replication of  for the law schooldata. The normal theory density curve is overlapped[&#64;ResamplingArticle]." src="Section8Bilder/bootstrap.png" />{#fig:bootstrap
width=”70%”}</p>
<p><br />
Another application of the resampling techniques is the estimation of
the bias (this is what the resampling was originally designed for). Let
<span class="math notranslate nohighlight">\(\hat{\theta} = \theta(\hat{F})\)</span> and define the bias
<span class="math notranslate nohighlight">\(\beta = E[\theta(\hat{F}) - \theta(F)]\)</span>, where F is the unknown parent
distribution and <span class="math notranslate nohighlight">\(\hat{F}\)</span> is the sampled distribution. We can consider
the bias just as another estimator and so we “bootstrap the bias” i.e.
compute the bootstrap estimate of the bias.
$<span class="math notranslate nohighlight">\(\hat{\beta}_B = \beta(\hat{F}) = E_*[\theta(\hat{F}^*) - \theta(\hat{F})]\)</span><span class="math notranslate nohighlight">\(
where \)</span>E_<em><span class="math notranslate nohighlight">\( is the expectation value on the bootstrap sampling and
\)</span>\hat{F}^</em><span class="math notranslate nohighlight">\( is the ECDF of the bootstrapped sample.\
\)</span>\beta_B<span class="math notranslate nohighlight">\( is computed with the same algorithm we used before to compute
\)</span>\sigma_B<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(\beta_B = \hat{\theta}^{*\cdot} - \hat{\theta} = \frac{1}{B}\sum_{b=1}^B (\hat{\theta}^{*\cdot} - \hat{\theta})\)</span><span class="math notranslate nohighlight">\(\
**Example** A common application of the resampling techniques is when
you apply two different estimators of the same parameter to the dataset
at hand and you ask yourself if the two estimates are compatible. We
will follow an example from literature [&#64;jackknifeHgg].\
The estimates of the best fit of the signal strength modifier of the
Higgs decaying into two photons are: for the first method
\)</span>0.54^{+0.31}<em>{-0.26}<span class="math notranslate nohighlight">\( for the second \)</span>0.96^{+0.37}</em>{-0.33}$.
Fig. <a class="reference external" href="#fig:jackknifeHgg">1.18</a>{reference-type=”ref”
reference=”fig:jackknifeHgg”} is the excerpt from the paper discussing
the compatibility.</p>
<p><img alt="[[fig:jackknifeHgg]]{#fig:jackknifeHgg label=&quot;fig:jackknifeHgg&quot;} compatibilitystudies." src="Section8Bilder/jackknifeHgg1.png" />{#fig:jackknifeHgg
width=”70%”} <img alt="[[fig:jackknifeHgg]]{#fig:jackknifeHgglabel=&quot;fig:jackknifeHgg&quot;}  compatibilitystudies." src="Section8Bilder/jackknifeHgg2.png" />{#fig:jackknifeHgg
width=”70%”}</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>G. Cowan [&#64;CowanBook], “Statistical Data Analysis”,Ch. 4</p></li>
<li><p>R. Barlow [&#64;Barlow], ” A guide to the use of statistical methods in
the physical sciences”. Ch. 8</p></li>
<li><p>W. Metzger [&#64;Metzger], “Statistical Methods in Data Analysis”: Ch.10</p></li>
<li><p>B. Efron and G. Gong , “A Leisurely Look at the Bootstrap, the
Jackknife, and Cross-Validation”, The American Statistician, Vol.
37, No. 1, (Feb., 1983), pp. 36-48</p></li>
<li><p>CMS collaboration, “Updated measurements of the Higgs boson at 125
GeV in the two photon decay channel”, CMS-PAS-HIG-13-001</p></li>
</ul>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>In a test beam, a beam of particles is prepared in a well defined
condition (particle type, energy, etc…) and it is typically used
to test a device under development. This configuration inverts the
typical experimental conditions where a device with known properties
is used to characterize particles in a beam or from collisions.</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>The typical criticism coming with this choice is on how we can be
sure that we control the test statistics to such extreme tails. The
typical answer is that such small values allow to a certain extent
to also cover for possible mis-estimations of systematic
uncertainties. It’s all hand-waving. The choice of the threshold to
claim a discovery remains subjective.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>The signal doesn’t always appear as an excess of events. In case
of test for neutrino oscillations the signal can appear as a deficit
of events.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">5</a></span></dt>
<dd><p>In 1-D the ordering is trivial, ascending/descending, in n-D it is
arbitrary, you have to choose a convention and map it to a 1D
sequence.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="leastSquares.html" title="previous page">Parameter Estimation - Least Squares {#sec:chi2}</a>
    <a class='right-next' id="next-link" href="confidenceIntervals.html" title="next page">Confidence Intervals {#ChapterConfidenceLimits}</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mauro Donega<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>